CREATE OR REPLACE PROCEDURE DEV_DM.SALESFORCE.SP_DM_CASE()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS CALLER
AS '
/*###############################################################################################################################################

    #    Date                Name                 Version                    Comment         #

    #    05-09-2024          Samuel             Initial Version             Loading STG_CASE to DM_CASE with no transformations  #
																			Truncate and load the data to DM Table	

    #################################################################################################################################################*/

BEGIN

			

            INSERT INTO DEV_DM.SALESFORCE.DM_CASE (Id, IsDeleted, MasterRecordId, CaseNumber, AccountId, AssetId, SourceId, ParentId, SuppliedName, SuppliedEmail, SuppliedPhone, SuppliedCompany, Type, Status, Reason, Origin, Language, Subject, Priority, Description, IsClosed, ClosedDate, IsEscalated, OwnerId, CreatedDate, CreatedById, LastModifiedDate, LastModifiedById, SystemModstamp, ContactPhone, ContactMobile, ContactEmail, ContactFax, Comments, LastViewedDate, LastReferencedDate, Initial_Risk_Assessment__c, Acceptable__c, Details_of_Investigation__c, Arrival_Airport__c, Why_1__c, Date_of_Event__c, Departure_Airport__c, Escalated_custom__c, Why_3__c, Response__c, Delay_Code__c, Why_4__c, Captain__c, First_Officer__c, Aircraft_Type__c, Aircraft_Registration__c, Client_Comments__c, Length_Of_Delay__c, ASQ_Owner_Qualifier__c, Cause_2__c, Cause_3__c, ASQ_Requires_Client_FollowUp__c, Issue_2__c, Issue_3__c, SMS__c, QMS__c, Aircraft_Flown__c, Aircraft_Flown_picklist__c, Departure_Airport_text__c, Arrival_Airport_text__c, Last_Status_DateTime__c, Why_5__c, Root_Cause_Other_Method__c, Root_cause__c, Findings_1__c, Findings_2__c, Findings_3__c, Findings_4__c, Findings_5__c, Investigation_Complete__c, Date__c, Human_Factors__c, X1_Organizational_Influences__c, X2_Supervisory_Factors__c, X3_Preconditions_for_Unsafe_Acts__c, X4_Unsafe_Acts__c, Hazard_Registry_Gap_Analysis__c, Notes__c, X1__c, X2_Title_Details__c, X3_Title_Details__c, X4_Title_Details__c, X5_Title_Details__c, Short_Long_Term__c, Short_Long_Term1__c, Short_Long_Term2__c, Short_Long_Term3__c, Target_Date1__c, Target_Date2__c, Target_Date3__c, Target_Date4__c, Target_Date5__c, Severity__c, Probability__c, Final_Probability__c, Final_Severity__c, Hazard_Registry_Safety_Risk_Profile__c, Complete1__c, Complete2__c, Complete3__c, Complete4__c, Complete5__c, Follow_Up__c, Non_Acceptable__c, Final_Risk_Assessment__c, Name__c, Date1__c, Complete6__c, Acceptable1__c, Non_Acceptable1__c, ASQ_Ready_for_Closure__c, ASQ__c, Short_Long_Term6__c, Date5__c, Why_6__c, Why_7__c, Owner_User1__c, Owner_User2__c, Owner_user3__c, Owner_user4__c, Owner_user5__c, Owner_user6__c, Related_ASQ__c, MOC__c, Kicked_Back_Comments__c, X1_Details_Comments__c, X2_Details_Comments__c, X3_Details_Comments__c, X4_Details_Comments__c, X5_Details_Comments__c, Description_of_Events__c, ATA_Codes_Pre2024__c, Issue_1__c, Cause_1__c, Reliability__c, ASQ_Requires_Reporter_FollowUp__c, Qualifier_Scale__c, Customer_Touchpoint__c, Department__c, Pilot_Flying__c, Influenceable__c, Event_Phase__c, Month__c, Daily_Metrics_Top_Concerns__c, External_Report_Required__c, External_Report_Type__c, Vendor__c, Reliability_Report_MoM__c, IOCC_Internal_Report__c, Flight_Safety_Officer_Comments__c, Total_Flights_Year__c, HFACS_Error_Classification__c, OHS__c, Finance_Internal_Report__c, Risk_Statement__c, Duplicate_ASQ__c, Learning__c, Lessons_Learned__c, Changes_Made__c, Check_Level__c, Original_Reporter_Feedback_Requested__c, Reporter_Feedback_Details__c, Injury_Data__c, WCB_Report_Reference__c, OHSHazardous_Occurrence__c, OHS_Notes__c, Workplace_Location__c, CLC_Employee_Complaint__c, AOSH_Onboard__c, Hide_ASQ_from_Staff_Community__c, Relevant_ASQ__c, Aircraft_Type_Group__c, KeyField_CreatedDate__c, KeyField_DateofEvent__c, Hazard_Name__c, AS_Issue_pick_Accommodations_for_Clients__c, AS_Issue_Pick_Accommodations_for_Staff__c, AS_Issue_Pick_Aircraft_Condition__c, AS_Issue_Pick_Aircraft_Damage__c, AS_Issue_Pick_Aircraft_Limitation_Exceed__c, AS_Issue_Pick_Airport_Change__c, AS_Issue_Pick_AirSprint_App__c, AS_Issue_Pick_Arrival_Delay__c, AS_Issue_Pick_Asset_Damage__c, HumanFactors_Lack_of_communication__c, HumanFactors_Complacency__c, HumanFactors_Lack_of_knowledge__c, HumanFactors_Distraction__c, HumanFactors_Lack_of_teamwork__c, HumanFactors_Fatigue__c, HumanFactors_Lack_of_resources__c, HumanFactors_Pressure__c, HumanFactors_Lack_of_assertiveness__c, HumanFactors_Stress__c, HumanFactors_Lack_of_Situational_Awarene__c, HumanFactors_Negative_Norms__c, Revenue_Count__c, RevCountAircraftGroup_KeyFieldSF__c, Accountid__c, DailyRevCountAircraftGroup_KeyFieldSF__c, Direct_Cost__c, Direct_Cost_USD__c, Indirect_Cost_CAD__c, Costing_Notes__c, ERC_Risk_Index__c, ERC_Outcome__c, Consequence__c, TSB_Regulator_Reportable__c, ATA_Code_1__c, ATA_Code_2__c, ATA_Code_3__c, Discrepancy_Summary_1__c, Discrepancy_Summary_2__c, Discrepancy_Summary_3__c, Workorder__c, Maintenance_Response__c, Probability_Code__c, Severity_Code__c, Risk_Assessment_Initial__c, Risk_Level__c, Severity_Code_Number__c, Risk_Value__c, Employee_Error__c, Fl3xx_Code__c, Client_Impact_Scale__c, Related_Audit__c, CADOR__c, Finding_Type__c, Repeat_Finding__c, Audit_Finding_Notes__c,TGT_UPDATE_DATE)
            SELECT
            Id,
            IsDeleted,
            MasterRecordId,
            CaseNumber,
            AccountId,
            AssetId,
            SourceId,
            ParentId,
            SuppliedName,
            SuppliedEmail,
            SuppliedPhone,
            SuppliedCompany,
            Type,
            Status,
            Reason,
            Origin,
            Language,
            Subject,
            Priority,
            Description,
            IsClosed,
            ClosedDate,
            IsEscalated,
            OwnerId,
            CreatedDate,
            CreatedById,
            LastModifiedDate,
            LastModifiedById,
            SystemModstamp,
            ContactPhone,
            ContactMobile,
            ContactEmail,
            ContactFax,
            Comments,
            LastViewedDate,
            LastReferencedDate,
            Initial_Risk_Assessment__c,
            Acceptable__c,
            Details_of_Investigation__c,
            Arrival_Airport__c,
            Why_1__c,
            Date_of_Event__c,
            Departure_Airport__c,
            Escalated_custom__c,
            Why_3__c,
            Response__c,
            Delay_Code__c,
            Why_4__c,
            Captain__c,
            First_Officer__c,
            Aircraft_Type__c,
            Aircraft_Registration__c,
            Client_Comments__c,
            Length_Of_Delay__c,
            ASQ_Owner_Qualifier__c,
            Cause_2__c,
            Cause_3__c,
            ASQ_Requires_Client_FollowUp__c,
            Issue_2__c,
            Issue_3__c,
            SMS__c,
            QMS__c,
            Aircraft_Flown__c,
            Aircraft_Flown_picklist__c,
            Departure_Airport_text__c,
            Arrival_Airport_text__c,
            Last_Status_DateTime__c,
            Why_5__c,
            Root_Cause_Other_Method__c,
            Root_cause__c,
            Findings_1__c,
            Findings_2__c,
            Findings_3__c,
            Findings_4__c,
            Findings_5__c,
            Investigation_Complete__c,
            Date__c,
            Human_Factors__c,
            X1_Organizational_Influences__c,
            X2_Supervisory_Factors__c,
            X3_Preconditions_for_Unsafe_Acts__c,
            X4_Unsafe_Acts__c,
            Hazard_Registry_Gap_Analysis__c,
            Notes__c,
            X1__c,
            X2_Title_Details__c,
            X3_Title_Details__c,
            X4_Title_Details__c,
            X5_Title_Details__c,
            Short_Long_Term__c,
            Short_Long_Term1__c,
            Short_Long_Term2__c,
            Short_Long_Term3__c,
            Target_Date1__c,
            Target_Date2__c,
            Target_Date3__c,
            Target_Date4__c,
            Target_Date5__c,
            Severity__c,
            Probability__c,
            Final_Probability__c,
            Final_Severity__c,
            Hazard_Registry_Safety_Risk_Profile__c,
            Complete1__c,
            Complete2__c,
            Complete3__c,
            Complete4__c,
            Complete5__c,
            Follow_Up__c,
            Non_Acceptable__c,
            Final_Risk_Assessment__c,
            Name__c,
            Date1__c,
            Complete6__c,
            Acceptable1__c,
            Non_Acceptable1__c,
            ASQ_Ready_for_Closure__c,
            ASQ__c,
            Short_Long_Term6__c,
            Date5__c,
            Why_6__c,
            Why_7__c,
            Owner_User1__c,
            Owner_User2__c,
            Owner_user3__c,
            Owner_user4__c,
            Owner_user5__c,
            Owner_user6__c,
            Related_ASQ__c,
            MOC__c,
            Kicked_Back_Comments__c,
            X1_Details_Comments__c,
            X2_Details_Comments__c,
            X3_Details_Comments__c,
            X4_Details_Comments__c,
            X5_Details_Comments__c,
            Description_of_Events__c,
            ATA_Codes_Pre2024__c,
            Issue_1__c,
            Cause_1__c,
            Reliability__c,
            ASQ_Requires_Reporter_FollowUp__c,
            Qualifier_Scale__c,
            Customer_Touchpoint__c,
            Department__c,
            Pilot_Flying__c,
            Influenceable__c,
            Event_Phase__c,
            Month__c,
            Daily_Metrics_Top_Concerns__c,
            External_Report_Required__c,
            External_Report_Type__c,
            Vendor__c,
            Reliability_Report_MoM__c,
            IOCC_Internal_Report__c,
            Flight_Safety_Officer_Comments__c,
            Total_Flights_Year__c,
            HFACS_Error_Classification__c,
            OHS__c,
            Finance_Internal_Report__c,
            Risk_Statement__c,
            Duplicate_ASQ__c,
            Learning__c,
            Lessons_Learned__c,
            Changes_Made__c,
            Check_Level__c,
            Original_Reporter_Feedback_Requested__c,
            Reporter_Feedback_Details__c,
            Injury_Data__c,
            WCB_Report_Reference__c,
            OHSHazardous_Occurrence__c,
            OHS_Notes__c,
            Workplace_Location__c,
            CLC_Employee_Complaint__c,
            AOSH_Onboard__c,
            Hide_ASQ_from_Staff_Community__c,
            Relevant_ASQ__c,
            Aircraft_Type_Group__c,
            KeyField_CreatedDate__c,
            KeyField_DateofEvent__c,
            Hazard_Name__c,
            AS_Issue_pick_Accommodations_for_Clients__c,
            AS_Issue_Pick_Accommodations_for_Staff__c,
            AS_Issue_Pick_Aircraft_Condition__c,
            AS_Issue_Pick_Aircraft_Damage__c,
            AS_Issue_Pick_Aircraft_Limitation_Exceed__c,
            AS_Issue_Pick_Airport_Change__c,
            AS_Issue_Pick_AirSprint_App__c,
            AS_Issue_Pick_Arrival_Delay__c,
            AS_Issue_Pick_Asset_Damage__c,
            HumanFactors_Lack_of_communication__c,
            HumanFactors_Complacency__c,
            HumanFactors_Lack_of_knowledge__c,
            HumanFactors_Distraction__c,
            HumanFactors_Lack_of_teamwork__c,
            HumanFactors_Fatigue__c,
            HumanFactors_Lack_of_resources__c,
            HumanFactors_Pressure__c,
            HumanFactors_Lack_of_assertiveness__c,
            HumanFactors_Stress__c,
            HumanFactors_Lack_of_Situational_Awarene__c,
            HumanFactors_Negative_Norms__c,
            Revenue_Count__c,
            RevCountAircraftGroup_KeyFieldSF__c,
            Accountid__c,
            DailyRevCountAircraftGroup_KeyFieldSF__c,
            Direct_Cost__c,
            Direct_Cost_USD__c,
            Indirect_Cost_CAD__c,
            Costing_Notes__c,
            ERC_Risk_Index__c,
            ERC_Outcome__c,
            Consequence__c,
            TSB_Regulator_Reportable__c,
            ATA_Code_1__c,
            ATA_Code_2__c,
            ATA_Code_3__c,
            Discrepancy_Summary_1__c,
            Discrepancy_Summary_2__c,
            Discrepancy_Summary_3__c,
            Workorder__c,
            Maintenance_Response__c,
            Probability_Code__c,
            Severity_Code__c,
            Risk_Assessment_Initial__c,
            Risk_Level__c,
            Severity_Code_Number__c,
            Risk_Value__c,
            Employee_Error__c,
            Fl3xx_Code__c,
            Client_Impact_Scale__c,
            Related_Audit__c,
            CADOR__c,
            Finding_Type__c,
            Repeat_Finding__c,
            Audit_Finding_Notes__c,
			CURRENT_TIMESTAMP
            FROM DEV_STG.SALESFORCE.STG_CASE;

TRUNCATE TABLE DEV_STG.SALESFORCE.STG_CASE;
RETURN ''Success'';
END;
';